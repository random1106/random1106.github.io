<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CTF Writeups</title>
  <meta name="description" content="Personal CTF writeups index" />
  <link href="/assets/css/main.css" rel="stylesheet">
</head>
<body>
  <div class="wrap" id="app">
    <header>
      <h1>CTF Writeups</h1>
    </header>

    <hr />

    <main id="writeups" aria-live="polite"></main>

    <footer>
      <hr />
      <p class="muted">© Yier Lin 2025</p>
    </footer>
  </div>

  <script>
    // === Data ================================================================
    // Add entries by pushing objects into ENTRIES.
    // Fields: title, event, date (YYYY-MM-DD), link, tags: [..]
    const ENTRIES = [
      {type:'ctf', title:'Sekai Meme Launcher', event:'Sekai CTF', date:'2025-08-16', link:'./memelauncher.html', tags:['blockchain']},
      {type:'ctf', title:'Dinosaur Park', event:'WWCTF', date:'2025-07-26', link:'./dinosaurpark.html', tags:['blockchain']},
      {type:'ctf', title:'Solidity Jail 2', event:'WWCTF', date:'2025-07-26', link:'./solidityjail2.html', tags:['blockchain']},
      {type:'ctf', title:'Solidity Jail 1', event:'WWCTF', date:'2025-07-26', link:'./solidityjail1.html', tags:['blockchain']},
      {type:'ctf', title:'NeverEnough', event:'smileyCTF', date:'2025-06-14', link:'#', tags:['crypto']},
      {type:'ctf', title:'multisig-wallet', event:'smileyCTF', date:'2025-06-14', link:'#', tags:['blockchain']},
      {type:'ctf', title:'Saas', event:'smileyCTF', date:'2025-06-14', link:'#', tags:['crypto']},
      {type:'note', title:'AES encryption attack summary', event:'Note', date:'2025-10-06', link:'../notes/AES.html', tags:['crypto']},
      {type:'others', title:'Won Top 3 in the Chainlink Reward competitive audit', event:'Others', date:'2025-08-16', link:'../others/chainlink.html', tags:['blockchain']}
    ];

    // === Render ==============================================================
    const $ = (s,sc=document)=>sc.querySelector(s);
    const byYearDesc = (a,b)=> b.localeCompare(a);

    function groupByYear(list){
      const map = new Map();
      for(const it of list){
        const y = it.date.slice(0,4);
        if(!map.has(y)) map.set(y,[]);
        map.get(y).push(it);
      }
      for(const [y,arr] of map){ arr.sort((a,b)=>b.date.localeCompare(a.date)); }
      return [...map.entries()].sort((a,b)=>byYearDesc(a[0],b[0]));
    }

    function itemHTML(it){
      const tagStr = it.tags?.map(t=>`<code>${t}</code>`).join(' ');
      return `<li>
        <div class="item-title"><a href="${it.link}">${it.title}</a></div>
        <div class="meta">${it.event} · <time datetime="${it.date}">${it.date}</time>${tagStr? ' · '+tagStr: ''}</div>
      </li>`
    }

    function renderSections(list){
      const container = document.getElementById('writeups');
      const byType = {
        ctf: list.filter(it=>it.type==='ctf'),
        note: list.filter(it=>it.type==='note'),
        others: list.filter(it=>it.type==='others')
      };

      container.innerHTML = `
        <section>
          <h2>Writeups</h2>
          ${renderGrouped(byType.ctf)}
        </section>
        <section>
          <h2>Notes</h2>
          ${renderGrouped(byType.note)}
        </section>
        <section>
          <h2>Others</h2>
          ${renderGrouped(byType.others)}
        </section>
      `;
    }

    function renderGrouped(list){
      if(!list.length) return '<p class="muted">No entries yet</p>';
      const groups = groupByYear(list);
      return groups.map(([year, items])=>{
        const itemsHTML = `<ul>${items.map(itemHTML).join('')}</ul>`;
        return `
          <details open>
            <summary>
              <h3 style="margin:0">${year}</h3>
              <span class="count">${items.length} item${items.length>1?'s':''}</span>
            </summary>
            ${itemsHTML}
          </details>
        `;
      }).join('');
    }


    renderSections(ENTRIES);

    // ===== Back-to-Top 按钮逻辑 =====
    const backTop = document.getElementById('backTop');
    window.addEventListener('scroll', () => {
      if (window.scrollY > 600) backTop.classList.add('show');
      else backTop.classList.remove('show');
    });
    backTop.addEventListener('click', () => {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    
  </script>
</body>
</html>